(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function H(){const e=document.querySelector(".slides"),t=document.querySelectorAll(".slides figure"),n=document.getElementById("btnPrev"),i=document.getElementById("btnNext"),s=document.querySelectorAll(".dot");if(!e||t.length===0||!n||!i||s.length===0)return;let a=0;const p=t.length;let E=!1;function L(){E||(E=!0,e.style.transform=`translateX(-${a*100}%)`,s.forEach((b,D)=>{b.classList.remove("bg-white","scale-125"),b.classList.add("bg-white/50"),D===a&&(b.classList.add("bg-white","scale-125"),b.classList.remove("bg-white/50"))}),setTimeout(()=>{E=!1},700))}n.addEventListener("click",()=>{E||(a=(a-1+p)%p,L())}),i.addEventListener("click",()=>{E||(a=(a+1)%p,L())}),s.forEach((b,D)=>{b.addEventListener("click",()=>{E||(a=D,L())})}),setInterval(()=>{a=(a+1)%p,L()},3500),L()}const r={breakpoints:{MOBILE:640},animation:{DURATION:700,TRANSITION:200,SLIDE_DISTANCE:30,DELAY_SHORT:50},selectors:{SERVICE_CARD:".service-card",EXPANDED_PANEL:"#expanded-panel",MOBILE_PANEL:"mobile-panel",PANEL_CONTENT:"panel-content",CLOSE_BUTTON:"close-panel"},styles:{BORDER:"3px solid #3FA9F5",BOX_SHADOW:"0 10px 30px rgba(63, 169, 245, 0.3)",INSET_SHADOW:"inset 0 10px 20px -10px rgba(0,0,0,0.3), inset 0 -10px 20px -10px rgba(0,0,0,0.3)"}},ae={1:{title:"Construcción Residencial",description:"Especialistas en construcción de viviendas unifamiliares y edificios residenciales con los más altos estándares de calidad.",details:["Viviendas unifamiliares","Edificios residenciales","Rehabilitación integral","Proyectos llave en mano"]},2:{title:"Construcción Industrial",description:"Desarrollo de naves industriales y espacios comerciales adaptados a las necesidades de cada cliente.",details:["Naves industriales","Almacenes logísticos","Centros comerciales","Espacios corporativos"]},3:{title:"Reformas Integrales",description:"Renovación completa de espacios, transformando su hogar o negocio con diseño moderno y funcional.",details:["Reformas de viviendas","Locales comerciales","Oficinas","Diseño de interiores"]},4:{title:"Instalaciones y Mantenimiento",description:"Servicios completos de instalaciones eléctricas, fontanería y sistemas de climatización.",details:["Instalaciones eléctricas","Fontanería","Climatización","Mantenimiento preventivo"]},5:{title:"Gestión de Proyectos",description:"Coordinación integral de proyectos de construcción desde la planificación hasta la entrega final.",details:["Planificación de proyectos","Control de calidad","Gestión de presupuestos","Coordinación de equipos"]},6:{title:"Asesoría Técnica",description:"Consultoría especializada en soluciones constructivas, normativas y optimización de recursos.",details:["Consultoría técnica","Estudios de viabilidad","Asesoramiento normativo","Certificaciones energéticas"]}},l={currentServiceOpen:null,currentClickedCard:null,isAnimating:!1,expandedPanel:null,serviceCards:null,reset(){this.currentServiceOpen=null,this.currentClickedCard=null,this.expandedPanel=null},setCurrentService(e,t){this.currentServiceOpen=e,this.currentClickedCard=t},setAnimating(e){this.isAnimating=e}};function M(){return window.innerWidth<r.breakpoints.MOBILE}function h(e){return new Promise(t=>setTimeout(t,e))}function W(e){return e.offsetHeight}function Z(e){const t=ae[e],n=t.details.map(i=>`
    <div class="bg-white bg-opacity-70 backdrop-blur-sm rounded-lg p-3 sm:p-4 shadow-sm">
      <p class="text-gray-800 text-sm sm:text-base">✓ ${i}</p>
    </div>
  `).join("");return`
    <div id="${r.selectors.PANEL_CONTENT}" 
         class="bg-[rgba(242,242,242,0.9)] backdrop-blur-sm text-center py-8 sm:py-12 lg:py-16 px-4 sm:px-6 lg:px-8 transition-all duration-200 ease-out w-full" 
         style="box-shadow: ${r.styles.INSET_SHADOW};">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-azul-oscuro mb-3 sm:mb-4">
        ${t.title}
      </h2>
      <p class="text-sm sm:text-base lg:text-lg text-gris-oscuro max-w-3xl mx-auto mb-6 sm:mb-8">
        ${t.description}
      </p>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 max-w-2xl mx-auto mb-6 sm:mb-8">
        ${n}
      </div>
      <button id="${r.selectors.CLOSE_BUTTON}" 
              class="bg-azul-oscuro text-white px-6 sm:px-8 py-2 sm:py-3 text-sm sm:text-base rounded-lg hover:bg-opacity-90 transition-all duration-300 shadow-md">
        Cerrar
      </button>
    </div>
  `}function le(e){return M()?ce(e):document.getElementById(r.selectors.EXPANDED_PANEL.substring(1))}function ce(e){let t=e.nextElementSibling;return t&&t.id===r.selectors.MOBILE_PANEL||(t=de(),e.parentNode.insertBefore(t,e.nextSibling)),t}function de(){const e=document.createElement("div");return e.id=r.selectors.MOBILE_PANEL,e.className="hidden transition-all duration-700 ease-in-out w-screen relative left-1/2 right-1/2 -ml-[50vw] -mr-[50vw]",e.style.opacity="0",e}function fe(){const e=document.getElementById(r.selectors.MOBILE_PANEL);e&&e!==l.expandedPanel&&(e.style.height="0",e.style.opacity="0",setTimeout(()=>e.remove(),r.animation.DURATION))}function F(e){me(),e&&ue(e)}function me(){l.serviceCards.forEach(e=>{e.classList.remove("active-service-card"),e.style.border="",e.style.transform="",e.style.boxShadow=""})}function ue(e){e.classList.add("active-service-card"),e.style.border=r.styles.BORDER,e.style.transform="scale(1.05)",e.style.boxShadow=r.styles.BOX_SHADOW}async function pe(e){e.innerHTML=Z(l.currentServiceOpen),e.style.height="0",e.style.overflow="hidden",e.classList.remove("hidden"),await h(r.animation.DELAY_SHORT),e.style.height="auto";const t=e.scrollHeight;e.style.height="0",W(e),await h(r.animation.DELAY_SHORT),e.style.height=`${t}px`,e.style.opacity="1",await h(r.animation.DURATION),e.style.height="auto",e.style.overflow="visible"}async function ge(e){const t=e.scrollHeight;e.style.height=`${t}px`,e.style.overflow="hidden",W(e),await h(r.animation.DELAY_SHORT),e.style.height="0",e.style.opacity="0",await h(r.animation.DURATION),e.classList.add("hidden"),e.innerHTML="",e.style.height="",e.style.overflow=""}async function he(e){if(l.isAnimating)return;l.setAnimating(!0);const t=document.getElementById(r.selectors.PANEL_CONTENT);t.style.transform=`translateY(-${r.animation.SLIDE_DISTANCE}px)`,t.style.opacity="0",await h(r.animation.TRANSITION),l.expandedPanel.innerHTML=Z(e);const n=document.getElementById(r.selectors.PANEL_CONTENT);n.style.transform=`translateY(${r.animation.SLIDE_DISTANCE}px)`,n.style.opacity="0",await h(r.animation.DELAY_SHORT),n.style.transform="translateY(0)",n.style.opacity="1",K(),l.setAnimating(!1)}async function _(e){const t=e.dataset.service;l.setCurrentService(t,e),F(e),M()&&fe(),l.expandedPanel=le(e),await pe(l.expandedPanel),K()}async function N(){l.expandedPanel&&(F(null),await ge(l.expandedPanel),l.expandedPanel.id===r.selectors.MOBILE_PANEL&&l.expandedPanel.remove(),l.reset())}async function ve(e){const t=e.dataset.service;l.currentServiceOpen===null?await _(e):l.currentServiceOpen!==t&&(M()?(await N(),await h(50),await _(e)):(l.setCurrentService(t,e),F(e),await he(t)))}function K(){const e=document.getElementById(r.selectors.CLOSE_BUTTON);e&&e.addEventListener("click",N)}function ye(){l.currentServiceOpen!==null&&N()}function Ee(){l.serviceCards.forEach(e=>{e.addEventListener("click",()=>ve(e))})}function be(){const e=[];return l.serviceCards.length||e.push("No se encontraron tarjetas de servicio"),document.getElementById(r.selectors.EXPANDED_PANEL.substring(1))||e.push("No se encontró el panel expandible"),e}function q(){l.serviceCards=document.querySelectorAll(r.selectors.SERVICE_CARD),console.log("ServicesGrid Debug:",{serviceCards:l.serviceCards.length,expandedPanel:!!document.getElementById(r.selectors.EXPANDED_PANEL.substring(1))});const e=be();if(e.length>0){console.warn("ServicesGrid:",e.join(", "));return}Ee(),window.addEventListener("resize",ye),console.log("ServicesGrid: Inicializado correctamente ✓")}const S={1:{title:"Reforma Industrial Planta A",description:"Renovación completa de instalaciones industriales con actualización de maquinaria y sistemas de seguridad.",details:["Superficie: 2,500 m²","Duración: 6 meses","Año: 2023","Cliente: Empresa Industrial XYZ"],images:["https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+A+-+Imagen+1","https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+A+-+Imagen+2","https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+A+-+Imagen+3"]},2:{title:"Reforma Industrial Planta B",description:"Ampliación y modernización de nave industrial con nuevas instalaciones eléctricas y sistemas de climatización.",details:["Superficie: 3,200 m²","Duración: 8 meses","Año: 2023","Cliente: Logística Industrial SA"],images:["https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+B+-+Imagen+1","https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+B+-+Imagen+2","https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+B+-+Imagen+3"]},3:{title:"Reforma Industrial Planta C",description:"Rehabilitación integral de instalaciones con mejoras en eficiencia energética y sostenibilidad.",details:["Superficie: 1,800 m²","Duración: 5 meses","Año: 2024","Cliente: Manufactura Moderna SL"],images:["https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+C+-+Imagen+1","https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+C+-+Imagen+2","https://via.placeholder.com/800x600/1E6091/ffffff?text=Reforma+Industrial+C+-+Imagen+3"]},4:{title:"Instalación Eléctrica Edificio A",description:"Instalación completa de sistemas eléctricos con domótica KNX para edificio de oficinas.",details:["Superficie: 1,200 m²","Duración: 4 meses","Año: 2023","Cliente: Corporación Empresarial"],images:["https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+A+-+Imagen+1","https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+A+-+Imagen+2","https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+A+-+Imagen+3"]},5:{title:"Instalación Eléctrica Edificio B",description:"Sistema eléctrico integral con tecnología de bajo consumo y paneles solares.",details:["Superficie: 950 m²","Duración: 3 meses","Año: 2024","Cliente: Green Building SA"],images:["https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+B+-+Imagen+1","https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+B+-+Imagen+2","https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+B+-+Imagen+3"]},6:{title:"Instalación Eléctrica Edificio C",description:"Modernización de instalaciones eléctricas con sistemas de seguridad avanzados.",details:["Superficie: 1,500 m²","Duración: 5 meses","Año: 2024","Cliente: Tech Hub Center"],images:["https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+C+-+Imagen+1","https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+C+-+Imagen+2","https://via.placeholder.com/800x600/3FA9F5/ffffff?text=Instalacion+Electrica+C+-+Imagen+3"]},7:{title:"Reforma Integral Vivienda 1",description:"Reforma completa de vivienda unifamiliar con redistribución de espacios y nuevas instalaciones.",details:["Superficie: 180 m²","Duración: 3 meses","Año: 2023","Cliente: Particular"],images:["https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+1+-+Imagen+1","https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+1+-+Imagen+2","https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+1+-+Imagen+3"]},8:{title:"Reforma Integral Vivienda 2",description:"Renovación de apartamento con cocina americana y baño completo, estilo moderno.",details:["Superficie: 95 m²","Duración: 2 meses","Año: 2024","Cliente: Particular"],images:["https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+2+-+Imagen+1","https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+2+-+Imagen+2","https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+2+-+Imagen+3"]},9:{title:"Reforma Integral Vivienda 3",description:"Rehabilitación de casa antigua conservando elementos originales con instalaciones modernas.",details:["Superficie: 220 m²","Duración: 4 meses","Año: 2024","Cliente: Particular"],images:["https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+3+-+Imagen+1","https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+3+-+Imagen+2","https://via.placeholder.com/800x600/0D3B66/ffffff?text=Reforma+Hogar+3+-+Imagen+3"]}};let J="reformas-industriales",y=null,u=0,v=!1,B=0,P=0,C=null,A=null,f=null,Q=null,ee=null,te=null,d=null,w=null,j=null,z=null,$=null;function k(e){if(v)return;J=e,v=!0,C.forEach(i=>{i.dataset.filter===e?i.classList.add("text-[var(--acento)]","scale-110"):i.classList.remove("text-[var(--acento)]","scale-110")});const t=Array.from(A).filter(i=>i.dataset.category!==e&&!i.classList.contains("hidden")),n=Array.from(A).filter(i=>i.dataset.category===e);t.forEach((i,s)=>{setTimeout(()=>{i.style.opacity="0",i.style.transform="scale(0.9)"},s*50)}),setTimeout(()=>{t.forEach(i=>{i.classList.add("hidden"),i.style.opacity="",i.style.transform=""}),n.forEach((i,s)=>{i.classList.remove("hidden"),i.style.opacity="0",i.style.transform="translateY(30px) scale(0.95)",setTimeout(()=>{i.style.transition="all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1)",i.style.opacity="1",i.style.transform="translateY(0) scale(1)"},s*100)}),setTimeout(()=>{v=!1,n.forEach(i=>{i.style.transition=""})},n.length*100+600)},t.length*50+300)}function X(e){const t=S[e];if(!t)return;y=e,u=0,Q.textContent=t.title,ee.textContent=t.description,te.innerHTML=t.details.map((i,s)=>`<li class="flex items-start opacity-0" style="animation: fadeInUp 0.5s ease forwards ${s*.1}s">
      <span class="text-[var(--acento)] mr-2">•</span>
      <span>${i}</span>
    </li>`).join("");const n=new Image;n.onload=()=>{d.src=t.images[u],d.style.opacity="1"},n.src=t.images[u],f.classList.remove("hidden"),f.classList.add("flex"),f.style.opacity="0",requestAnimationFrame(()=>{f.style.transition="opacity 0.3s ease",f.style.opacity="1"}),document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${window.scrollY}px`,t.images.slice(1).forEach(i=>{const s=new Image;s.src=i})}function T(){f.style.opacity="0",setTimeout(()=>{f.classList.add("hidden"),f.classList.remove("flex");const e=document.body.style.top;document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,parseInt(e||"0")*-1),y=null,u=0,f.style.opacity=""},300)}function ne(e="next"){if(!y||v)return;v=!0;const t=S[y],n=e==="next"?"translateX(-100px)":"translateX(100px)";d.style.transition="all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",d.style.opacity="0",d.style.transform=n,setTimeout(()=>{d.src=t.images[u];const i=e==="next"?"translateX(100px)":"translateX(-100px)";d.style.transition="none",d.style.transform=i,d.offsetHeight,d.style.transition="all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",d.style.opacity="1",d.style.transform="translateX(0)",setTimeout(()=>{v=!1,d.style.transition="",d.style.transform=""},300)},300)}function O(){if(!y||v)return;const e=S[y];u=(u-1+e.images.length)%e.images.length,ne("prev")}function R(){if(!y||v)return;const e=S[y];u=(u+1)%e.images.length,ne("next")}function xe(e){B=e.changedTouches[0].screenX}function Le(e){P=e.changedTouches[0].screenX,Ie()}function Ie(){P<B-50&&R(),P>B+50&&O()}function Ae(){if(document.getElementById("projects-animations"))return;const e=document.createElement("style");e.id="projects-animations",e.textContent=`
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  `,document.head.appendChild(e)}function Y(){if(Ae(),C=document.querySelectorAll(".filter-btn"),A=document.querySelectorAll(".project-card"),f=document.getElementById("project-modal"),Q=document.getElementById("modal-title"),ee=document.getElementById("modal-description"),te=document.getElementById("modal-details"),d=document.getElementById("carousel-image"),w=document.getElementById("carousel-container"),j=document.getElementById("carousel-prev"),z=document.getElementById("carousel-next"),$=document.getElementById("modal-close"),!C.length||!A.length||!f){console.warn("ProjectsGrid: No se encontraron todos los elementos necesarios");return}C.forEach(e=>{e.addEventListener("click",()=>{k(e.dataset.filter)})}),A.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.project;X(t)}),e.setAttribute("tabindex","0"),e.addEventListener("keydown",t=>{if(t.key==="Enter"||t.key===" "){t.preventDefault();const n=e.dataset.project;X(n)}})}),$.addEventListener("click",T),j.addEventListener("click",O),z.addEventListener("click",R),w&&(w.addEventListener("touchstart",xe,{passive:!0}),w.addEventListener("touchend",Le,{passive:!0})),f.addEventListener("click",e=>{e.target===f&&T()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&!f.classList.contains("hidden")&&T()}),document.addEventListener("keydown",e=>{f.classList.contains("hidden")||(e.key==="ArrowLeft"?(e.preventDefault(),O()):e.key==="ArrowRight"&&(e.preventDefault(),R()))}),k(J),console.log("ProjectsGrid: Inicializado correctamente ✓"),console.log("- Soporte táctil: ✓"),console.log("- Navegación por teclado: ✓"),console.log("- Animaciones optimizadas: ✓")}const c={validation:{nombre:{minLength:3,maxLength:100,pattern:/^[a-záéíóúñA-ZÁÉÍÓÚÑ\s]+$/,errorMessages:{empty:"El nombre es obligatorio",minLength:"El nombre debe tener al menos 3 caracteres",pattern:"El nombre solo puede contener letras y espacios"}},telefono:{pattern:/^[0-9]{9,15}$/,errorMessages:{empty:"El teléfono es obligatorio",pattern:"El teléfono debe tener entre 9 y 15 dígitos"}},email:{pattern:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,errorMessages:{empty:"El email es obligatorio",pattern:"El email no tiene un formato válido"}},descripcion:{minLength:20,maxLength:1e3,errorMessages:{empty:"La descripción del proyecto es obligatoria",minLength:"La descripción debe tener al menos 20 caracteres",maxLength:"La descripción no puede superar los 1000 caracteres"}},fotos:{maxFiles:5,maxSize:5*1024*1024,allowedTypes:["image/jpeg","image/jpg","image/png","image/webp"],errorMessages:{maxFiles:"Solo puedes subir un máximo de 5 fotos",maxSize:"Cada foto no puede superar los 5MB",invalidType:"Solo se permiten archivos JPG, PNG o WEBP"}}},selectors:{form:"#contact-form",fields:{nombre:"#nombre",telefono:"#telefono",email:"#email",descripcion:"#descripcion",fotos:"#fotos",privacidad:"#privacidad"},dropArea:"#drop-area",previewContainer:"#preview-container",photoCounter:"#photo-counter",photoCount:"#photo-count",submitButton:"#submit-button",buttonText:"#button-text",buttonLoading:"#button-loading",formMessage:"#form-message"}},m={isSubmitting:!1,selectedFiles:[],validationErrors:{}};let o={};function I(e,t){const n=c.validation[e];return n?!t||t.trim()===""?{valid:!1,error:n.errorMessages.empty}:n.minLength&&t.length<n.minLength?{valid:!1,error:n.errorMessages.minLength}:n.maxLength&&t.length>n.maxLength?{valid:!1,error:n.errorMessages.maxLength}:n.pattern&&!n.pattern.test(t)?{valid:!1,error:n.errorMessages.pattern}:{valid:!0}:{valid:!0}}function we(e){const t=c.validation.fotos,n=[];if(e.length>t.maxFiles)return{valid:!1,error:t.errorMessages.maxFiles};for(let i=0;i<e.length;i++){const s=e[i];t.allowedTypes.includes(s.type)||n.push(`${s.name}: ${t.errorMessages.invalidType}`),s.size>t.maxSize&&n.push(`${s.name}: ${t.errorMessages.maxSize}`)}return n.length>0?{valid:!1,error:n.join(`
`)}:{valid:!0}}function x(e,t){const n=o.fields[e];if(!n)return;n.classList.add("border-red-500","focus:ring-red-500"),n.classList.remove("border-gray-300","focus:ring-[#0D3B66]");const i=n.parentElement.querySelector(".error-message");i&&(i.textContent=t,i.classList.remove("hidden")),m.validationErrors[e]=t}function g(e){const t=o.fields[e];if(!t)return;t.classList.remove("border-red-500","focus:ring-red-500"),t.classList.add("border-gray-300","focus:ring-[#0D3B66]");const n=t.parentElement.querySelector(".error-message");n&&(n.textContent="",n.classList.add("hidden")),delete m.validationErrors[e]}function Ce(){let e=!0;return["nombre","telefono","email","descripcion"].forEach(t=>{const n=o.fields[t];if(!n)return;const i=I(t,n.value);i.valid?g(t):(x(t,i.error),e=!1)}),o.fields.privacidad.checked?g("privacidad"):(x("privacidad","Debes aceptar la política de privacidad"),e=!1),e}function ie(e){const t=we(e);if(!t.valid){alert(t.error);return}m.selectedFiles=Array.from(e),oe(m.selectedFiles),se()}function oe(e){o.previewContainer.innerHTML="",o.previewContainer.classList.remove("hidden"),e.forEach((t,n)=>{const i=new FileReader;i.onload=s=>{const a=Se(s.target.result,t.name,n);o.previewContainer.appendChild(a)},i.readAsDataURL(t)})}function Se(e,t,n){const i=document.createElement("div");return i.className="relative group",i.innerHTML=`
    <img src="${e}" alt="${t}" 
         class="w-full h-24 sm:h-32 object-cover rounded-lg border-2 border-gray-200 group-hover:border-[#0D3B66] transition-all">
    
    <button type="button" 
            class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-all shadow-md opacity-0 group-hover:opacity-100"
            onclick="window.contactForm.removeImage(${n})"
            title="Eliminar imagen">
      ✕
    </button>
    
    <p class="text-xs text-gray-600 mt-1 truncate" title="${t}">
      ${t}
    </p>
  `,i}function De(e){m.selectedFiles.splice(e,1),m.selectedFiles.length===0?(o.previewContainer.classList.add("hidden"),o.photoCounter.classList.add("hidden"),o.fields.fotos.value=""):oe(m.selectedFiles),se()}function se(){const e=m.selectedFiles.length;e===0?o.photoCounter.classList.add("hidden"):(o.photoCounter.classList.remove("hidden"),o.photoCount.textContent=e)}function Te(e){e.preventDefault(),e.stopPropagation(),o.dropArea.classList.add("border-[#0D3B66]","bg-blue-50")}function Be(e){e.preventDefault(),e.stopPropagation(),o.dropArea.classList.remove("border-[#0D3B66]","bg-blue-50")}function Pe(e){e.preventDefault(),e.stopPropagation(),o.dropArea.classList.remove("border-[#0D3B66]","bg-blue-50");const t=e.dataTransfer.files;t.length>0&&ie(t)}function G(e,t){o.formMessage.classList.remove("hidden","bg-green-100","bg-red-100","text-green-800","text-red-800"),o.formMessage.classList.add("bg-red-100","text-red-800"),o.formMessage.textContent=t,o.formMessage.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>{o.formMessage.classList.add("hidden")},5e3)}function U(e){m.isSubmitting=e,e?(o.submitButton.disabled=!0,o.submitButton.classList.add("opacity-50","cursor-not-allowed"),o.buttonText.classList.add("hidden"),o.buttonLoading.classList.remove("hidden")):(o.submitButton.disabled=!1,o.submitButton.classList.remove("opacity-50","cursor-not-allowed"),o.buttonText.classList.remove("hidden"),o.buttonLoading.classList.add("hidden"))}function Oe(){const e=new FormData(o.form);return e.delete("fotos"),m.selectedFiles.forEach(t=>{e.append("fotos",t)}),e}async function Re(e){if(e.preventDefault(),!m.isSubmitting){if(!Ce()){G("error","Por favor, corrige los errores antes de enviar el formulario");return}U(!0);try{const t=Oe(),n=await fetch(o.form.action||"/contact/",{method:"POST",body:t,redirect:"follow"});if(n.ok||n.redirected)window.location.href=n.url;else throw new Error(`Error del servidor: ${n.status}`)}catch(t){console.error("❌ Error al enviar el formulario:",t),G("error","Hubo un error al enviar el formulario. Por favor, inténtalo de nuevo."),U(!1)}}}function Me(){o.fields.nombre.addEventListener("blur",()=>{const e=I("nombre",o.fields.nombre.value);e.valid?g("nombre"):x("nombre",e.error)}),o.fields.telefono.addEventListener("blur",()=>{const e=I("telefono",o.fields.telefono.value);e.valid?g("telefono"):x("telefono",e.error)}),o.fields.email.addEventListener("blur",()=>{const e=I("email",o.fields.email.value);e.valid?g("email"):x("email",e.error)}),o.fields.descripcion.addEventListener("blur",()=>{const e=I("descripcion",o.fields.descripcion.value);e.valid?g("descripcion"):x("descripcion",e.error)}),["nombre","telefono","email","descripcion"].forEach(e=>{o.fields[e].addEventListener("input",()=>{m.validationErrors[e]&&g(e)})}),o.fields.privacidad.addEventListener("change",()=>{o.fields.privacidad.checked&&g("privacidad")}),o.fields.fotos.addEventListener("change",e=>{e.target.files.length>0&&ie(e.target.files)}),o.dropArea.addEventListener("click",()=>{o.fields.fotos.click()}),o.dropArea.addEventListener("dragover",Te),o.dropArea.addEventListener("dragleave",Be),o.dropArea.addEventListener("drop",Pe),o.form.addEventListener("submit",Re)}function V(){const e=document.querySelector(c.selectors.form);if(!e){console.log("ContactForm: No se encontró el formulario en esta página");return}o={form:e,fields:{nombre:document.querySelector(c.selectors.fields.nombre),telefono:document.querySelector(c.selectors.fields.telefono),email:document.querySelector(c.selectors.fields.email),descripcion:document.querySelector(c.selectors.fields.descripcion),fotos:document.querySelector(c.selectors.fields.fotos),privacidad:document.querySelector(c.selectors.fields.privacidad)},dropArea:document.querySelector(c.selectors.dropArea),previewContainer:document.querySelector(c.selectors.previewContainer),photoCounter:document.querySelector(c.selectors.photoCounter),photoCount:document.querySelector(c.selectors.photoCount),submitButton:document.querySelector(c.selectors.submitButton),buttonText:document.querySelector(c.selectors.buttonText),buttonLoading:document.querySelector(c.selectors.buttonLoading),formMessage:document.querySelector(c.selectors.formMessage)};const t=Object.entries(o.fields).filter(([n,i])=>!i).map(([n])=>n);if(t.length>0){console.error("ContactForm: Faltan elementos del DOM:",t);return}Me(),window.contactForm={removeImage:De},console.log("ContactForm: Inicializado correctamente ✓")}const re=window.matchMedia("(prefers-reduced-motion: reduce)").matches;function Fe(){if(re){document.querySelectorAll(".reveal").forEach(t=>{t.classList.add("visible")});return}const e=new IntersectionObserver(t=>{t.forEach(n=>{if(n.isIntersecting){const i=n.target.dataset.delay||0;setTimeout(()=>{n.target.classList.add("visible")},Number(i)),e.unobserve(n.target)}})},{threshold:.15,rootMargin:"0px 0px -40px 0px"});document.querySelectorAll(".reveal").forEach(t=>e.observe(t))}function Ne(){const e=document.querySelector("header");if(!e)return;let t=!1;window.addEventListener("scroll",()=>{t||(window.requestAnimationFrame(()=>{window.scrollY>20?e.classList.add("header-scrolled"):e.classList.remove("header-scrolled"),t=!1}),t=!0)})}function He(){if(re)return;const e=document.querySelectorAll(".timeline-node");if(e.length===0)return;const t=new IntersectionObserver(n=>{n.forEach(i=>{i.isIntersecting&&(i.target.classList.add("visible"),t.unobserve(i.target))})},{threshold:.5});e.forEach(n=>t.observe(n))}function _e(){Fe(),Ne(),He()}document.addEventListener("DOMContentLoaded",()=>{_e(),typeof H=="function"&&H(),typeof q=="function"&&q(),typeof Y=="function"&&Y(),typeof V=="function"&&V(),qe()});function qe(){const e=document.getElementById("menuToggle"),t=document.getElementById("mobileMenu");e&&t&&e.addEventListener("click",()=>{const n=!t.classList.contains("hidden");t.classList.toggle("hidden"),n?e.classList.remove("shadow-inner","bg-white/20","scale-95"):e.classList.add("shadow-inner","bg-white/20","scale-95")})}
